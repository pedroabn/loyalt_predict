SELECT 
       t1.dtRef, 
       t1.idCliente,
       t1.idadeDias,
       t2.idadeDias,
       t5.flEmail, 
       t2.qtdeAtivacaoVida,
       t2.qtdeAtivacaoD7,
       t2.qtdeAtivacaoD14,
       t2.qtdeAtivacaoD28,
       t2.qtdeAtivacaoD56,
       t2.qtdeTransacaoVida,
       t2.qtdeTransacaoD7,
       t2.qtdeTransacaoD14,
       t2.qtdeTransacaoD28,
       t2.qtdeTransacaoD56,
       t2.saldoVida,
       t2.saldoD7,
       t2.saldoD14,
       t2.saldoD28,
       t2.saldoD56,
       t2.qtdePontosPosVida,
       t2.qtdePontosPosD7,
       t2.qtdePontosPosD14,
       t2.qtdePontosPosD28,
       t2.qtdePontosPosD56,
       t2.qtdePontosNegVida,
       t2.qtdePontosNegD7,
       t2.qtdePontosNegD14,
       t2.qtdePontosNegD28,
       t2.qtdePontosNegD56,
       t2.qtdeTransacaoManha,
       t2.qtdeTransacaoTarde,
       t2.qtdeTransacaoNoite,
       t2.pctTransacaoManha,
       t2.pctTransacaoTarde,
       t2.pctTransacaoNoite,
       t2.QtdeTransacaoDiaVida,
       t2.QtdeTransacaoDiaD7,
       t2.QtdeTransacaoDiaD14,
       t2.QtdeTransacaoDiaD28,
       t2.QtdeTransacaoDiaD56,
       t2.pctAtivacaoMAU,
       t2.qtdeHorasVida,
       t2.qtdeHorasD7,
       t2.qtdeHorasD14,
       t2.qtdeHorasD28,
       t2.qtdeHorasD56,
       t2.avgIntervaloDiasVida,
       t2.avgIntervaloDiasD28,
       t2.qteChatMessage,
       t2.qteAirflowLover,
       t2.qteRLover,
       t2.qteResgatarPonei,
       t2.qteListadepresenca,
       t2.qtePresencaStreak,
       t2.qteTrocaStreamElements,
       t2.qteReembolsoStreamElements,
       t2.qtdeRPG,
       t2.qtdeChurnModel,
       t3.qtdFreq,
       t3.descLifeCycleFoto,
       t3.descLifeCycleD28,
       t3.pctCurioso,
       t3.pctFiel,
       t3.pctTurista,
       t3.pctDesencantada,
       t3.pctZumbi,
       t3.pctReconquistado,
       t3.pctReborn,
       t3.avgFreqGrupo,
       t3.ratioFreqGrupo,
       t4.qtdeCursosCompletos,
       t4.qtdeCursosIncompletos,
       t4.carreira,
       t4.coletaDados2024,
       t4.dsDatabricks2024,
       t4.dsPontos2024,
       t4.estatistica2024,
       t4.estatistica2025,
       t4.github2024,
       t4.github2025,
       t4.iaCanal2025,
       t4.lagoMago2024,
       t4.machineLearning2025,
       t4.matchmakingTramparDeCasa2024,
       t4.ml2024,
       t4.mlflow2025,
       t4.pandas2024,
       t4.pandas2025,
       t4.python2024,
       t4.python2025,
       t4.sql2020,
       t4.sql2025,
       t4.streamlit2025,
       t4.tramparLakehouse2024,
       t4.tseAnalytics2024,
       t4.qtdDiasUltiAtividade

FROM fs_transacional AS t1

LEFT JOIN fs_life_cycle AS t2
ON t1.IdCliente = t2.IdCliente
AND t1.dtRef = t2.dtRef

LEFT JOIN fs_educational AS t3
ON t1.IdCliente = t3.IdCliente
AND t1.dtRef = t3.dtRef

LEFT JOIN clients AS t4
ON t1.IdCliente = t4.IdCliente

WHERE t1.dtRef = (SELECT MAX(dtRef) FROM fs_transacional);